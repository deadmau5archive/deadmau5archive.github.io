var itemsPerPage=50;function onLoadTagSvg(e,a){e.contentDocument.getElementById("rect4136").style.fill="#"+a}function showAllTags(e){e.style.display="none";var a=document.getElementsByClassName("searchTag");for(var t of a)t.style.display="inline-block"}function loadTags(e,a,t,i){getCategories(s=>{var n=[];for(var l in s){(d=s[l]).id=l,n.push(d)}n.sort((e,a)=>a.count-e.count),n.sort(function(e,a){var i=e.id==t;return(a.id==t)-i});for(var r="",o=0;o<n.length;o++){var d=n[o],c=t==d.id;r+='<a class="searchTag'+(c?" active":"")+'" style="'+(o<3?"":"display:none;")+(c?"background:#"+d.color+";":"")+"border-color:#"+d.color+';" href="?'+(i?"p=1&":"")+"tagFilter="+d.id+'">'+escapeHtml(d.text)+' <i class="searchTagCount">'+d.count+"</i></a> "}n.length>3&&(r+='<a href="#!" onclick="showAllTags(this)" title="show all tags">...</a> '),t>0&&(r='<a href="?'+(i?"p=1":"")+'" title="remove filter"><b style="color:#f00;">X</b></a> '+r),r="<b>Filter by tag: &emsp; </b>"+r,document.getElementById("tagFilter").innerHTML=r;var g=function(a){for(var t of(null==e&&(e=Object.keys(a)),e))if(t in a){var i=a[t],n=[];for(var l of i){var r=s[l];r.id=l,n.push(r)}var o=document.getElementById("tags_"+t);if(null!=o){var d=[],c="";n.sort((e,a)=>a.count-e.count);for(var g=0;g<5&&g<n.length;g++)d.push(n[g].text),c+='<div style="z-index:'+(1e3-g)+';overflow:shown;pointer-events:none;vertical-align:top;display:inline-block;width:8px;height:12px;"><object id="tgsvg_'+t+"_"+n[g].id+'" onload="onLoadTagSvg(this, \''+n[g].color+'\')" data="/media/tag.svg" type="image/svg+xml" width="12px" height="12px" ></object></div>';o.innerHTML='<div style="display:inline-block;padding-right:6px;">'+c+"</div>"+(n.length>5?'<i style="opacity:0.4;">+'+(n.length-5)+"</i>":""),o.title="Tags: "+d.join(", ")+(n.length>5?" ("+(n.length-5)+" more)":""),o.style.display="inline-block"}}};null!=a?g(a):getTags(g)})}function loadPages(){var e=new URL(window.location.href),a=e.searchParams.get("p"),t="",i=-1,s=e.searchParams.get("tagFilter");if(null==s||isNaN(s)||(i=parseInt(s),t="&tagFilter="+s),null!=a){var n=null,l=function(e){var s=Math.ceil(e.length/itemsPerPage),l=0,r=0,o=0,d=!1,c=[];if("all"==a){d=!0,r=e.length;var g=document.getElementById("pagesAllToggle");g.innerHTML="Show pages",g.href="/page?p=1"}else isNaN(a)||(l=(o=parseInt(a)-1)*itemsPerPage,r=Math.min(e.length,l+itemsPerPage));if(l>=0&&l<e.length){for(var v=e.slice(l,r),p="",m=0;m<v.length;m++){var f=v[m],u="";"T"==f.t?u='<img src="/media/twitch.png" class="icon" title="streamed on twitch">':"M"==f.t&&(u='<img src="/media/mixer.png" class="icon" title="streamed on mixer">');var h='<span class="title">'+f.h+"</span>";h+='<span class="vidno">'+u+" "+f.n+"</span><br>",h+='<span class="game">'+f.c+"</span>";var b="/thumb/"+f.s+".jpg",y='<div class="thumbnailContainer thumbnailContainerShade"></div>';1==f.b&&(y='<div class="thumbnailContainer"><div class="thumbnail thumbnailAnimated"><img src="/storyboard/'+f.s+'.jpg" /></div></div>');var w='<div class="preview">'+('<div class="thumbnail"><div class="previewImg" style="background: url(\''+b+"');\"></div></div>"+y+'<div class="overlaybox timecontainer"><img src="/media/play.png"> '+f.r+'</div><div class="overlaybox datecontainer">'+f.d+'</div><div id="tags_'+f.s+'" class="overlaybox tagcontainer"></div>'+f.g)+'</div><div class="textbox">'+h+"</div>";p+='<a href="/videos/'+f.s+'"><div class="vidbox">'+w+"</div></a>",c.push(f.s)}document.getElementById("page_videos").innerHTML=p}var T="";if(!d)for(m=0;m<s;m++)T+='<a href="/page?p='+(m+1)+t+'" class="btn'+(m==o?" active":"")+'">'+(m+1)+"</a> ";document.getElementById("page_buttons").innerHTML=T;var k="";k=d?"All videos":(o-1>=0?'<a href="/page?p='+o+t+'" class="btn">&#9664;</a>&emsp;':"")+"Page <b>"+(o+1)+"</b> of <b>"+s+"</b>&emsp;"+(o+1<s?'<a href="/page?p='+(o+2)+t+'" class="btn">&#9654;</a>':""),document.getElementById("page_info").innerHTML=k,loadTags(c,n,i,!0)},r=i>0?function(e){getTags(a=>{n=a;var t=e.filter(function(e){return!!(e.s in a&&a[e.s].includes(i))});l(t)})}:l;load("/page/pages.txt?nc="+Date.now(),r)}else window.location.href="/page?p=1"}function loadList(){var e=new URL(window.location.href),a=-1,t=e.searchParams.get("tagFilter");null==t||isNaN(t)||(a=parseInt(t));var i=function(e){loadTags(null,e,a,!1)};a>0?getTags(e=>{var t=document.getElementsByClassName("listtableRow");for(var s of t){var n=s.dataset.v;n in e&&e[n].includes(a)||(s.style.display="none")}i(e)}):i(null)}function listShowMarkers(){var e=document.getElementsByClassName("listMarkerList"),a=document.getElementById("markerListSelect"),t=a.value;if("none"!=t){for(var i of e)i.style.display="block";var s=function(e){var a=document.getElementsByClassName("listtableRow"),i={};for(var s of a){i[s.dataset.v]=s.dataset.offsets.split(",").map(e=>parseInt(e))}var n={};for(var l in e){var r=l.split("/"),o=r[0];for(var d of(o in n||(n[o]=[]),e[l])){var c=parseInt(r[1]);d.link=o,o in i&&c<i[o].length&&(d.offset_p=d.offset+i[o][c]),n[o].push(d)}}for(var l in n){var g=n[l],v="",p=0;for(var d of g){var m=!1;if(null!=username&&username==d.by&&(m=!0),("comm"!=t||!m)&&("my"!=t||m)){var f=d.by,u=escapeHtml(d.text),h='<div style="vertical-align:baseline;display:inline-block;width:10px;height:10px;background:#'+d.color+';border-radius:6px;"></div>';m&&(f='<span title="you" style="color:#47f;">'+f+"</span>");var b="offset_p"in d?d.offset_p:d.offset;v+='<div><a class="timestamp" href="/videos/'+d.link+"?t="+b+'">'+toTimestamp(b)+"</a>&ensp;"+h+"&emsp;"+u+'&emsp;<i style="color:gray;">by '+f+"</i></div>",p++}}v=p>0?'<hr style="border:none;border-top: 1px solid #333;"><b>Markers</b> ('+p+"):<br> "+v:"";var y=document.getElementById("markers_"+l);y&&(y.innerHTML=v)}};null==listMarkerList?(a.disabled=!0,getMarkers(e=>{listMarkerList=e,a.disabled=!1,s(e)})):s(listMarkerList)}else for(var i of e)i.style.display="none"}listMarkerList=null;
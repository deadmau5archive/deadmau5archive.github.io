var itemsPerPage=50;function onLoadTagSvg(e,a){e.contentDocument.getElementById("rect4136").style.fill="#"+a}function showAllTags(e){e.style.display="none";var a=document.getElementsByClassName("searchTag");for(var t of a)t.style.display="inline-block"}function loadTags(e,a,t,i){getCategories(s=>{var l=[];for(var n in s){var r=s[n];r.id=n,l.push(r)}l.sort((e,a)=>a.count-e.count),l.sort(function(e,a){var i=e.id==t;return(a.id==t)-i});for(var o="",c=0;c<l.length;c++){var r=l[c],d=t==r.id;o+='<a class="searchTag'+(d?" active":"")+'" style="'+(c<10?"":"display:none;")+(d?"background:#"+r.color+";":"")+"border-color:#"+r.color+';" href="?'+(i?"p=1&":"")+"tagFilter="+r.id+'">'+escapeHtml(r.text)+' <i class="searchTagCount">'+r.count+"</i></a> "}l.length>10&&(o+='<a href="#!" onclick="showAllTags(this)" title="show all tags">...</a> '),t>0&&(o='<a href="?'+(i?"p=1":"")+'" title="remove filter"><b style="color:#f00;">X</b></a> '+o),o="<b>Filter by tag: &emsp; </b>"+o,document.getElementById("tagFilter").innerHTML=o;var g=function(a){for(var t of(null==e&&(e=Object.keys(a)),e))if(t in a){var i=a[t],l=[];for(var n of i){var r=s[n];r.id=n,l.push(r)}var o=document.getElementById("tags_"+t);if(null!=o){var c=[],d="";l.sort((e,a)=>a.count-e.count);for(var g=0;g<5&&g<l.length;g++)c.push(l[g].text),d+='<div style="z-index:'+(1e3-g)+';overflow:shown;pointer-events:none;vertical-align:top;display:inline-block;width:8px;height:12px;"><object id="tgsvg_'+t+"_"+l[g].id+'" onload="onLoadTagSvg(this, \''+l[g].color+'\')" data="/media/tag.svg" type="image/svg+xml" width="12px" height="12px" ></object></div>';o.innerHTML='<div style="display:inline-block;padding-right:6px;">'+d+"</div>"+(l.length>5?'<i style="opacity:0.4;">+'+(l.length-5)+"</i>":""),o.title="Tags: "+c.join(", ")+(l.length>5?" ("+(l.length-5)+" more)":""),o.style.display="inline-block"}}};null!=a?g(a):getTags(g)})}function loadPages(){var e=new URL(window.location.href),a=e.searchParams.get("p"),t="",i=-1,s=e.searchParams.get("tagFilter");null==s||isNaN(s)||(i=parseInt(s),t="&tagFilter="+s);var l=function(e){if(0==e.length)return"";var a="";for(var t of e)switch(t){case"ytb-some":a+='<img src="/media/ytb-some.png" class="icon" title="video blocked in some countries" /> ';break;case"ytb-all":a+='<img src="/media/ytb-all.png" class="icon" title="some audio removed to prevent block" /> ';break;case"error":a+='<img src="/media/nope.png" class="icon" title="could not be processed" /> ';break;case"muted":a+='<img src="/media/mute.png" class="icon" title="has muted segments" /> ';break;case"unmuted":a+='<img src="/media/unmuted.png" class="icon" title="has unmuted segments" /> ';break;case"discontinuity":a+='<img src="/media/warn.png" class="icon" title="has discontinuity errors" /> ';break;case"length":a+='<img src="/media/length.png" class="icon" title="length mismatch" /> ';break;case"lock":a+='<img src="/media/lock.png" class="icon" title="access restricted video" /> '}return'<div class="overlaybox lblcontainer">'+a+"</div>"};if(null!=a){var n=null,r=function(e){var s=Math.ceil(e.length/itemsPerPage),r=0,o=0,c=0,d=!1,g=[];if("all"==a){d=!0,o=e.length;var v=document.getElementById("pagesAllToggle");v.innerHTML="Show pages",v.href="/page?p=1"}else isNaN(a)||(r=(c=parseInt(a)-1)*itemsPerPage,o=Math.min(e.length,r+itemsPerPage));if(r>=0&&r<e.length){for(var m=e.slice(r,o),p="",f=0;f<m.length;f++){var u=m[f],h="";"T"==u.t?h='<img src="/media/twitch.png" class="icon" title="streamed on twitch">':"M"==u.t&&(h='<img src="/media/mixer.png" class="icon" title="streamed on mixer">');var b='<span class="title">'+("h"in u&&null!=u.h?escapeHtml(u.h):'<i style="opacity:0.4;" title="no original title specified">deadmau5 livestream</i>')+"</span>";b+='<span class="vidno">'+h+("n"in u&&null!=u.n?" "+u.n:"")+"</span><br>",b+='<span class="game">'+("c"in u&&null!=u.c?escapeHtml(u.c):"")+"</span>";var y="/media/default_thumbs/default.png";1==u.i?y="/thumb/"+u.s+".jpg":2==u.i&&(y="/media/default_thumbs/not_yet_uploaded.png");var $='<div class="thumbnailContainer thumbnailContainerShade"></div>';1==u.b&&($='<div class="thumbnailContainer"><div class="thumbnail thumbnailAnimated"><img src="/storyboard/'+u.s+'.jpg" /></div></div>');var k=l(u.g),_='<div class="preview">'+('<div class="thumbnail"><div class="previewImg" style="background: url(\''+y+"');\"></div></div>"+$+'<div class="overlaybox timecontainer"><img src="/media/play.png"> '+u.r+'</div><div class="overlaybox datecontainer">'+u.d+'</div><div id="tags_'+u.s+'" class="overlaybox tagcontainer"></div>')+k+'</div><div class="textbox">'+b+"</div>";p+='<a href="/videos/'+u.s+'"><div class="vidbox">'+_+"</div></a>",g.push(u.s)}document.getElementById("page_videos").innerHTML=p}var x="";if(!d)for(var f=0;f<s;f++)x+='<a href="/page?p='+(f+1)+t+'" class="btn'+(f==c?" active":"")+'">'+(f+1)+"</a> ";document.getElementById("page_buttons").innerHTML=x;var w="";w=d?"All videos":(c-1>=0?'<a href="/page?p='+c+t+'" class="btn">&#9664;</a>&emsp;':"")+"Page <b>"+(c+1)+"</b> of <b>"+s+"</b>&emsp;"+(c+1<s?'<a href="/page?p='+(c+2)+t+'" class="btn">&#9654;</a>':""),document.getElementById("page_info").innerHTML=w,loadTags(g,n,i,!0)},o=function(e){getTags(a=>{n=a;var t=e.filter(function(e){return!!(e.s in a&&a[e.s].includes(i))});r(t)})},c=i>0?o:r;load("/data/pages.json?nc="+Date.now(),c)}else window.location.href="/page?p=1"}function loadList(){var e=new URL(window.location.href),a=-1,t=e.searchParams.get("tagFilter");null==t||isNaN(t)||(a=parseInt(t));var i=function(e){loadTags(null,e,a,!1)};a>0?getTags(e=>{var t=document.getElementsByClassName("listtableRow");for(var s of t){var l=s.dataset.v;l in e&&e[l].includes(a)||(s.style.display="none")}i(e)}):i(null)}function listShowMarkers(){var e=document.getElementsByClassName("listMarkerList"),a=document.getElementById("markerListSelect"),t=a.value;if("none"!=t){for(var i of e)i.style.display="block";var s=function(e){var a=document.getElementsByClassName("listtableRow"),i={};for(var s of a)i[s.dataset.v]=s.dataset.offsets.split(",").map(e=>parseInt(e));var l={};for(var n in e){var r=n.split("/"),o=r[0];for(var c of(o in l||(l[o]=[]),e[n])){var d=parseInt(r[1]);c.link=o,o in i&&d<i[o].length&&(c.offset_p=c.offset+i[o][d]),l[o].push(c)}}for(var n in l){var g=l[n],v="",m=0;for(var c of g){var p=!1;if(null!=username&&username==c.by&&(p=!0),("comm"!=t||!p)&&("my"!=t||p)){var f=c.by,u=escapeHtml(c.text),h='<div style="vertical-align:baseline;display:inline-block;width:10px;height:10px;background:#'+c.color+';border-radius:6px;"></div>';p&&(f='<span title="you" style="color:#47f;">'+f+"</span>");var b="offset_p"in c?c.offset_p:c.offset;v+='<div><a class="timestamp" href="/videos/'+c.link+"?t="+b+'">'+toTimestamp(b)+"</a>&ensp;"+h+"&emsp;"+u+'&emsp;<i style="color:gray;">by '+f+"</i></div>",m++}}v=m>0?'<hr style="border:none;border-top: 1px solid #333;"><b>Markers</b> ('+m+"):<br> "+v:"";var y=document.getElementById("markers_"+n);y&&(y.innerHTML=v)}};null==listMarkerList?(a.disabled=!0,getMarkers(e=>{listMarkerList=e,a.disabled=!1,s(e)})):s(listMarkerList)}else for(var i of e)i.style.display="none"}listMarkerList=null;
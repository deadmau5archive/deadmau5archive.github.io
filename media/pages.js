var itemsPerPage=50;function onLoadTagSvg(a,b){a.contentDocument.getElementById("rect4136").style.fill="#"+b}function showAllTags(a){a.style.display="none";var b=document.getElementsByClassName("searchTag");for(var c of b)c.style.display="inline-block"}function loadTags(a,b,c,d){getCategories(i=>{var g=[];for(var j in i){var e=i[j];e.id=j,g.push(e)}g.sort((a,b)=>b.count-a.count),g.sort(function(a,b){var d=a.id==c;return(b.id==c)-d});for(var f="",h=0;h<g.length;h++){var e=g[h],k=c==e.id;f+='<a class="searchTag'+(k?" active":"")+'" style="'+(h<10?"":"display:none;")+(k?"background:#"+e.color+";":"")+"border-color:#"+e.color+';" href="?'+(d?"p=1&":"")+"tagFilter="+e.id+'">'+escapeHtml(e.text)+' <i class="searchTagCount">'+e.count+"</i></a> "}g.length>10&&(f+='<a href="#!" onclick="showAllTags(this)" title="show all tags">...</a> '),c>0&&(f='<a href="?'+(d?"p=1":"")+'" title="remove filter"><b style="color:#f00;">X</b></a> '+f),f="<b>Filter by tag: &emsp; </b>"+f,document.getElementById("tagFilter").innerHTML=f;var l=function(g){for(var e of(null==a&&(a=Object.keys(g)),a))if(e in g){var m=g[e],b=[];for(var h of m){var j=i[h];j.id=h,b.push(j)}var f=document.getElementById("tags_"+e);if(null!=f){var k=[],l="";b.sort((a,b)=>b.count-a.count);for(var d=5,c=0;c<d&&c<b.length;c++)k.push(b[c].text),l+='<div style="z-index:'+(1e3-c)+';overflow:shown;pointer-events:none;vertical-align:top;display:inline-block;width:8px;height:12px;"><object id="tgsvg_'+e+"_"+b[c].id+'" onload="onLoadTagSvg(this, \''+b[c].color+'\')" data="/media/tag.svg" type="image/svg+xml" width="12px" height="12px" ></object></div>';f.innerHTML='<div style="display:inline-block;padding-right:6px;">'+l+"</div>"+(b.length>d?'<i style="opacity:0.4;">+'+(b.length-d)+"</i>":""),f.title="Tags: "+k.join(", ")+(b.length>d?" ("+(b.length-d)+" more)":""),f.style.display="inline-block"}}};null!=b?l(b):getTags(l)})}function loadPages(){var b=new URL(window.location.href),d=b.searchParams.get("p"),e="",c=-1,a=b.searchParams.get("tagFilter");null==a||isNaN(a)||(c=parseInt(a),e="&tagFilter="+a);var i=function(b){if(0==b.length)return"";var a="";for(var c of b)switch(c){case"ytb-some":a+='<img src="/media/ytb-some.png" class="icon" title="video blocked in some countries" /> ';break;case"ytb-all":a+='<img src="/media/ytb-all.png" class="icon" title="some audio removed to prevent block" /> ';break;case"error":a+='<img src="/media/nope.png" class="icon" title="could not be processed" /> ';break;case"muted":a+='<img src="/media/mute.png" class="icon" title="has muted segments" /> ';break;case"unmuted":a+='<img src="/media/unmuted.png" class="icon" title="has unmuted segments" /> ';break;case"discontinuity":a+='<img src="/media/warn.png" class="icon" title="has discontinuity errors" /> ';break;case"length":a+='<img src="/media/length.png" class="icon" title="length mismatch" /> ';break;case"lock":a+='<img src="/media/lock.png" class="icon" title="access restricted video" /> '}return'<div class="overlaybox lblcontainer">'+a+"</div>"};if(null!=d){var j=null,f=function(g){var k=Math.ceil(g.length/itemsPerPage),h=0,l=0,f=0,m=!1,q=[];if("all"==d){m=!0,l=g.length;var r=document.getElementById("pagesAllToggle");r.innerHTML="Show pages",r.href="/page?p=1"}else isNaN(d)||(h=(f=parseInt(d)-1)*itemsPerPage,l=Math.min(g.length,h+itemsPerPage));if(h>=0&&h<g.length){for(var s=g.slice(h,l),t="",b=0;b<s.length;b++){var a=s[b],n="";"T"==a.t?n='<img src="/media/twitch.png" class="icon" title="streamed on twitch">':"M"==a.t&&(n='<img src="/media/mixer.png" class="icon" title="streamed on mixer">');var o='<span class="title">'+("h"in a&&null!=a.h?escapeHtml(a.h):'<i style="opacity:0.4;" title="no original title specified">deadmau5 livestream</i>')+"</span>";o+='<span class="vidno">'+n+("n"in a&&null!=a.n?" "+a.n:"")+"</span><br>",o+='<span class="game">'+("c"in a&&null!=a.c?escapeHtml(a.c):"")+"</span>";var p="/media/default_thumbs/default.png";1==a.i?p="/thumb/"+a.s+".jpg":2==a.i&&(p="/media/default_thumbs/not_yet_uploaded.png");var u='<div class="thumbnailContainer thumbnailContainerShade"></div>';1==a.b&&(u='<div class="thumbnailContainer"><div class="thumbnail thumbnailAnimated"><img src="/storyboard/'+a.s+'.jpg" /></div></div>');var x=i(a.g),y='<div class="preview">'+('<div class="thumbnail"><div class="previewImg" style="background: url(\''+p+"');\"></div></div>"+u+'<div class="overlaybox timecontainer"><img src="/media/play.png"> '+a.r+'</div><div class="overlaybox datecontainer">'+a.d+'</div><div id="tags_'+a.s+'" class="overlaybox tagcontainer"></div>'+x)+'</div><div class="textbox">'+o+"</div>";t+='<a href="/videos/'+a.s+'"><div class="vidbox">'+y+"</div></a>",q.push(a.s)}document.getElementById("page_videos").innerHTML=t}var v="";if(!m)for(var b=0;b<k;b++)v+='<a href="/page?p='+(b+1)+e+'" class="btn'+(b==f?" active":"")+'">'+(b+1)+"</a> ";document.getElementById("page_buttons").innerHTML=v;var w="";w=m?"All videos":(f-1>=0?'<a href="/page?p='+f+e+'" class="btn">&#9664;</a>&emsp;':"")+"Page <b>"+(f+1)+"</b> of <b>"+k+"</b>&emsp;"+(f+1<k?'<a href="/page?p='+(f+2)+e+'" class="btn">&#9654;</a>':""),document.getElementById("page_info").innerHTML=w,loadTags(q,j,c,!0)},g=function(a){getTags(b=>{j=b;var d=a.filter(function(a){return!!(a.s in b&&b[a.s].includes(c))});f(d)})},h=c>0?g:f;load("/data/pages.json?nc="+Date.now(),h)}else window.location.href="/page?p=1"}function loadList(){var c=new URL(window.location.href),b=-1,a=c.searchParams.get("tagFilter");null==a||isNaN(a)||(b=parseInt(a));var d=function(a){loadTags(null,a,b,!1)};b>0?getTags(a=>{var f=document.getElementsByClassName("listtableRow");for(var c of f){var e=c.dataset.v;e in a&&a[e].includes(b)||(c.style.display="none")}d(a)}):d(null)}function listShowMarkers(){var b=document.getElementsByClassName("listMarkerList"),c=document.getElementById("markerListSelect"),d=c.value;if("none"!=d){for(var a of b)a.style.display="block";var e=function(k){var q=document.getElementsByClassName("listtableRow"),f={};for(var l of q)f[l.dataset.v]=l.dataset.offsets.split(",").map(a=>parseInt(a));var c={};for(var e in k){var m=e.split("/"),b=m[0];for(var a of(b in c||(c[b]=[]),k[e])){var n=parseInt(m[1]);a.link=b,b in f&&n<f[b].length&&(a.offset_p=a.offset+f[b][n]),c[b].push(a)}}for(var e in c){var r=c[e],g="",i=0;for(var a of r){var h=!1;if(null!=username&&username==a.by&&(h=!0),("comm"!=d||!h)&&("my"!=d||h)){var j=a.by,s=escapeHtml(a.text),t='<div style="vertical-align:baseline;display:inline-block;width:10px;height:10px;background:#'+a.color+';border-radius:6px;"></div>';h&&(j='<span title="you" style="color:#47f;">'+j+"</span>");var o="offset_p"in a?a.offset_p:a.offset;g+='<div><a class="timestamp" href="/videos/'+a.link+"?t="+o+'">'+toTimestamp(o)+"</a>&ensp;"+t+"&emsp;"+s+'&emsp;<i style="color:gray;">by '+j+"</i></div>",i++}}g=i>0?'<hr style="border:none;border-top: 1px solid #333;"><b>Markers</b> ('+i+"):<br> "+g:"";var p=document.getElementById("markers_"+e);p&&(p.innerHTML=g)}};null==listMarkerList?(c.disabled=!0,getMarkers(a=>{listMarkerList=a,c.disabled=!1,e(a)})):e(listMarkerList)}else for(var a of b)a.style.display="none"}listMarkerList=null
function loadFormFromLink(){var e=new URL(window.location.href).searchParams.get("t");null!=e?loadFormWithToken(e):document.getElementById("form_container").innerHTML='no form to load. <br><br><a href="/" class="shade">Go home</a>'}var formContent=[],formSubmitToken=null;function loadFormWithToken(e){var t=document.getElementById("form_container");t.innerHTML="<i>loading...</i>",formsGet(e,e=>{for(var n of(formContent=e.form,formSubmitToken=e.submit_token,t.innerHTML="",formContent)){var r=n.type,a=document.createElement("div");if(a.className="form-element","textinput"==r||"textarea"==r||"select"==r){var l=document.createElement("span");l.innerHTML=n.label,"required"in n&&n.required&&(l.innerHTML+=' <span title="required" style="color:red;">*</span>'),a.appendChild(l),a.appendChild(document.createElement("br"))}if("heading"==r)a.innerHTML="<h2>"+n.text+"</h2>";else if("text"==r){var i=n.text;i=(i=(i=(i=(i=i.replaceAll(/\[([^\]]+)\]\(\<(http\S*)\>\)/gi,'<a href="$2" class="shade" target="_blank">$1</a>')).replaceAll(/\<(http\S*)\>/gi,'<a href="$1" class="shade" target="_blank">$1</a>')).replaceAll(/\*\*(.*)\*\*/gi,"<b>$1</b>")).replaceAll(/\*(.*)\*/gi,"<i>$1</i>")).replaceAll("\r","").replaceAll("\n","<br>"),a.innerHTML=i}else if("button"==r){var o=document.createElement("button");o.type="button",o.innerHTML=n.label,o.onclick=function(e,t){return function(){formButton(e,t)}}(o,n),a.appendChild(o)}else if("textinput"==r){var m=document.createElement("input");m.type="text",m.id="forminput_"+n.name,a.appendChild(m)}else if("textarea"==r){var m=document.createElement("textarea");m.id="forminput_"+n.name,a.appendChild(m)}else if("select"==r){var f=document.createElement("div");for(var p of n.options)f.innerHTML+='<label> <input type="checkbox" id="forminput_'+n.name+"_"+p.value+'"> '+p.label+" </label><br>";a.appendChild(f)}t.appendChild(a)}})}function formButton(e,t){if(e.disabled=!0,"submit"==t.action){var n={};for(var r of formContent)if("name"in r){var a=r.type,l=r.name,i=null;if("textinput"==a||"textarea"==a)i=document.getElementById("forminput_"+l).value;else if("select"==a)for(var o of(i=[],r.options))document.getElementById("forminput_"+l+"_"+o.value).checked&&i.push(o.value);n[l]=i}formsSubmit(formSubmitToken,n,e=>{var t=e.next;null!=t&&loadFormWithToken(t)},()=>{setTimeout(()=>{e.disabled=!1},500)})}}
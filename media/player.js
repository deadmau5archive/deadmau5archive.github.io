var player,playerContainer,boundingRect,playerChat,playerChatType,theatreModeToggleBtn,descBarToggleBtn,descBarToggleBtn2,videoBox,descBox,timelineBox,progressInfo,localTimeInfo,videoStartTime,progressInfo2="";window.onload=function(){loadPlayer(),playerContainer=document.getElementById("playerContainer"),videoBox=document.getElementById("videoBox"),playerChat=document.getElementById("player_chat"),playerChatType=document.getElementById("chat").dataset.chattype,timelineBox=document.getElementsByClassName("videoTimelineInfoBox")[0],descBox=document.getElementById("desc"),(theatreModeToggleBtn=document.createElement("div")).setAttribute("id","toggleTheatreBtn"),theatreModeToggleBtn.className="descBtn",theatreModeToggleBtn.innerHTML='<div onclick="toggleTheatre()"><img src="/media/theatre.png" class="icon"></div>',descBox.appendChild(theatreModeToggleBtn),(descBarToggleBtn=document.createElement("div")).className="descBtn",descBarToggleBtn.innerHTML='<div onclick="toggleDescBar()"><img src="/media/descbtn.png" class="icon"></div>',descBarToggleBtn.style.right="50px",descBox.appendChild(descBarToggleBtn),(descBarToggleBtn2=descBarToggleBtn.cloneNode(!0)).innerHTML='<div onclick="toggleDescBar()"><img src="/media/descbtn2.png" class="icon"></div>',descBarToggleBtn2.style.top="20px",descBarToggleBtn2.style.right="28px",descBarToggleBtn2.style.zIndex="1",descBarToggleBtn2.style.display="none",descBarToggleBtn2Cnt=document.createElement("div"),descBarToggleBtn2Cnt.style.position="relative",descBarToggleBtn2Cnt.style.width="100%",descBarToggleBtn2Cnt.style.height=0,descBarToggleBtn2Cnt.appendChild(descBarToggleBtn2),videoBox.appendChild(descBarToggleBtn2Cnt),(progressInfo=document.createElement("div")).className="descRight",progressInfo.innerHTML="00:00:00",descBox.appendChild(progressInfo),(localTimeInfo=document.createElement("div")).className="descRight localTime",localTimeInfo.title="JoelTimeâ„¢",localTimeInfo.innerHTML="00:00",localTimeInfo.style.display="none",localTimeInfo.onclick=function(){timeFormat24h=!timeFormat24h,updateTimestamp()},descBox.appendChild(localTimeInfo),recalculateSizes(),window.onresize=function(){recalculateSizes()};var e=document.getElementById("videoCount");e&&load("/about/videocount.txt",function(t){var a=e.dataset.count;e.innerHTML+=" / "+t[a]});var t=atob("c2hvd19kb3dubG9hZF9idXR0b249MQ=="),a=atob("c2V0RG93bmxvYWRCdXR0b25FbmFibGVk"),o=new URL(window.location.href).searchParams.get(a);if(null!=o&&"1"==o){var n=new Date;n.setTime(n.getTime()+432e8),document.cookie=t+"; expires="+n.toUTCString()+"; path=/"}if(-1!==document.cookie.indexOf(t)){var l=document.getElementById("chat").dataset.id;linkBox=document.getElementsByClassName("links")[0];var i=document.createElement("a");i.setAttribute("target","_blank"),i.setAttribute("href",atob("aHR0cHM6Ly9kNS1hcmNoaXZlLWRsLmhlcm9rdWFwcC5jb20vZG93bmxvYWQv")+l),i.className="btn",i.innerHTML=atob("PGltZyBzcmM9Ii9tZWRpYS9kbC5wbmciIGNsYXNzPSJpY29uIj4gRG93bmxvYWQ="),linkBox.appendChild(i)}};var timeFormat24h=!0;function updateTimestamp(){if(null!=player){progressInfo.innerHTML=toTimestamp(player.getCurrentTime())+" / "+progressInfo2;var e=Math.floor(videoStartTime+player.getCurrentTime()),t=new Date(1e3*e).toLocaleString("en-US",{timeZone:"America/Toronto"}),a=new Date(t),o=a.getHours(),n=a.getMinutes();localTimeInfo.innerHTML=timeFormat24h?(o<10?"0"+o:o)+":"+(n<10?"0"+n:n):(o%12==0?12:o%12)+":"+(n<10?"0"+n:n)+" "+(o<12?"AM":"PM"),localTimeInfo.style.display="block"}}var descBarVisible=!0,descBarHidingAvailable=!0;function toggleDescBar(){showDescBar(descBarVisible=!descBarVisible),recalculateSizes()}function showDescBar(e){e?(descBox.style.display="block",timelineBox.style.display="block",descBarToggleBtn.style.display="block",descBarToggleBtn2.style.display="none"):(descBox.style.display="none",timelineBox.style.display="none",descBarToggleBtn.style.display="none",descBarToggleBtn2.style.display="block")}var chatInit=!1,theatreMode=!1,bodyScrollTop=0;function toggleTheatre(){(theatreMode=!theatreMode)?(bodyScrollTop=window.pageYOffset||document.documentElement.scrollTop,playerContainer.className="theatre",playerChat.className="theatre",theatreModeToggleBtn.className="descBtn theatre",document.body.style.overflow="hidden"):(playerContainer.className="",theatreModeToggleBtn.className="descBtn",recalculateSizes(),document.body.style.overflow="",window.scrollTo(0,bodyScrollTop))}function playerChatModeChange(e){(descBarHidingAvailable=!e)?showDescBar(descBarVisible):(showDescBar(!0),descBarToggleBtn.style.display="none",descBarToggleBtn2.style.display="none")}function recalculateSizes(){if(!theatreMode){var e=window.innerWidth-18;if(e>=960){descBarHidingAvailable&&playerChatModeChange(!0);var t=1436-e,a=Math.min(1024,1024-t);videoBox.style.width=a+"px",setTimeout(()=>{(boundingRect=videoBox.getBoundingClientRect()).y+=window.scrollY,playerChat.style.left=a+20+"px",playerChat.style.top=boundingRect.y+"px",playerChat.className="right";var e=2;"mixer"==playerChatType&&(e=0),playerChat.style.height=boundingRect.height-e+"px"},1)}else descBarHidingAvailable||playerChatModeChange(!1),videoBox.style.width="100%",setTimeout(()=>{playerChat.className="",playerChat.style.left=0,playerChat.style.top=0,playerChat.style.height=Math.min(.5*playerContainer.clientWidth,260)+"px"},1);playerContainer.style.height=playerContainer.clientWidth/16*9+"px",chatInit||(playerChat.style.display="block",chatInit=!0)}}function loadPlayer(){var e=document.getElementById("youtube-player");videoStartTime=parseInt(e.dataset.pstarttime),player=new YT.Player("youtube-player",{height:"100%",width:"100%",videoId:e.dataset.video,playerVars:{autoplay:1},events:{onReady:function(t){progressInfo2=toTimestamp(t.target.getDuration());var a=readTimeFromUrl();-1!=a&&(t.target.cueVideoById({videoId:e.dataset.video,startSeconds:a}),t.target.playVideo()),updateTimestamp(),setInterval(updateTimestamp,200),loadChat()}}})}function loadChat(){var e=document.getElementById("chat"),t=e.dataset.id,a=e.dataset.offset,o=e.dataset.chattype,n=0,l=!1;"full"==a?l=!0:n=parseInt(a),dontShowChatHeader=!0,displayChat(t,e,l,o,n)}
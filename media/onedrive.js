var loginComment="please log in to manage OneDrive verification";function loadVerificationState(){var e=Math.round(+new Date/1e3),n='<div class="infobox infobox-gray"> ❌ It looks like you have not yet set up OneDrive access in this browser. You can do so below. </div>',t=getCookie("d5a_onedrive_verification");if(null!=t){var o="success",i="✔️ <b>You have set up OneDrive access in this browser.</b>",a="If you have recently cleared cookies or the verification has expired, you may need to do it again.";try{var l=JSON.parse(atob(t));l&&"lt"in l&&l.lt<e-259200?(o="warn",i="⚠️ <b>You have set up OneDrive access in this browser, but it likely expired.</b>",a="You have not accessed the OneDrive share in 5+ days so your login most likely expired and you'll need to re-verify."):l&&"lu"in l&&l.lu!=uuidstr&&(o="warn",i="⚠️ <b>OneDrive access is set up with another account in this browser.</b>",a="If you share the same access level as that account, you might be able to use the existing verification. Otherwise, you'll have to <b>clear cookies on the OneDrive share site</b> and then re-verify.",document.getElementById("hintClearCookies").style.display="list-item")}catch(s){}n='<div class="infobox infobox-'+o+'"> '+i+" <br><i>"+a+"</i> </div>"}document.getElementById("verification_state").innerHTML=n}var onedriveCodeInterval=null;function odSetupBegin(){document.getElementById("od_step0").style.display="none",document.getElementById("od_step1").style.display="block",onedriveVerificationCreate(e=>{document.getElementById("share_link").href=e.link,document.getElementById("od_step1").style.display="none",document.getElementById("od_step2").style.display="block"})}function odSetupCodefetch(){setTimeout(()=>{var e=document.getElementById("code_hint");null!=e&&(e.innerHTML="<i>Waiting for your code...<i><br><i>This can take a few seconds.</i>")},1e3),onedriveCodeInterval=setInterval(()=>{onedriveVerificationGetCode(e=>{e.success&&(clearInterval(onedriveCodeInterval),document.getElementById("code_box").innerHTML=e.code,document.getElementById("code_box").classList.add("codeBoxActive"))})},1e3)}function odSetupComplete(){document.getElementById("od_step2").style.display="none",document.getElementById("od_step3").style.display="block";var e=new Date(Date.now()+31536e6),n=Math.round(+new Date/1e3),t={ct:n,lt:n,cu:uuidstr,lu:uuidstr};document.cookie="d5a_onedrive_verification="+btoa(JSON.stringify(t))+"; expires="+e.toUTCString()+"; path=/",loadVerificationState()}function loadPageContent(){document.getElementById("pre-login").style.display="none",document.getElementById("content").style.display="block",loadVerificationState(),null!=new URL(window.location.href).searchParams.get("showSetUp")&&(document.getElementById("verification_box").style.background="#ff0",setTimeout(()=>{document.getElementById("verification_box").style.background="transparent"},100))}function loginCallback(e){e?loadPageContent():document.getElementById("pre-login").innerHTML="<h2>Please log in</h2> <br> <p>"+loginComment+'</p> <br> <a class="shade" href="#!" onclick="connectionsShowLogin()">Login</a>'}function connectionsShowLogin(){session?loadPageContent():showLoginPane(loginComment,loginCallback)}waitforSession(()=>{connectionsShowLogin()});